defaults:
  - domain_randomization: default_dom_rand_conf
  - override hydra/job_logging: default
  - override hydra/launcher: basic

hydra:
  mode: MULTIRUN
  job_logging: {}
  hydra_logging: {}
  sweeper:
    params:
#      experiment.learnable_std: true, false
#      experiment.init_std: 0.1, 0.2
#      experiment.num_steps: 10, 20
#      experiment.update_epochs: 4
#      experiment.clip_eps: 0.2, 0.05
      # env_params
      experiment.env_params.reward_params.air_time_coeff: 0.25, 0.1
      experiment.env_params.reward_params.joint_acc_coeff: 2e-7, 3e-7
      experiment.env_params.reward_params.air_time_max: 0.1, 0.5
      experiment.env_params.reward_params.joint_torque_coeff: 5e-6, 2e-5
      experiment.env_params.reward_params.joint_position_limit_coeff: 1.0, 5.0
      experiment.env_params.reward_params.action_rate_coeff: 1e-2, 1e-3

wandb:
  project: "unitreeH1_PD"

experiment:
  task_factory:
    name: RLFactory
    params: {}
  env_params:
    env_name: MjxUnitreeH1
    headless: True
    horizon: 1000
    terminal_state_type: HeightBasedTerminalStateHandler
    goal_type: GoalRandomRootVelocity
    reward_type: LocomotionReward
    reward_params:
      tracking_w_exp_xy: 4.0
      tracking_w_exp_yaw: 4.0
      tracking_w_sum_xy: 2.0
      tracking_w_sum_yaw: 1.0
      nominal_joint_pos_coeff: 0.2
      joint_torque_coeff: 5e-6
      air_time_coeff: 0.0
      joint_acc_coeff: 2e-7
      air_time_max: 0.5
      joint_position_limit_coeff: 5.0
      action_rate_coeff: 0.01
      nominal_joint_pos_names: [back_bkz, l_arm_shy, l_arm_shx, l_arm_shz, left_elbow,
                                r_arm_shy, r_arm_shx, r_arm_shz, right_elbow]
    #terrain_type: RoughTerrain
    init_state_type: DefaultInitialStateHandler
    domain_randomization_type: DefaultRandomizer
    domain_randomization_params: ${domain_randomization}
    timestep: 0.004 # 250 Hz
    n_substeps: 5   # 50 Hz
    observation_spec:
      - type: ProjectedGravityVector
        obs_name: q_root
        xml_name: root
      - type: JointPosArray
        obs_name: joint_positions
        xml_names:
          - back_bkz
          - l_arm_shy
          - l_arm_shx
          - l_arm_shz
          - left_elbow
          - r_arm_shy
          - r_arm_shx
          - r_arm_shz
          - right_elbow
          - hip_flexion_r
          - hip_adduction_r
          - hip_rotation_r
          - knee_angle_r
          - ankle_angle_r
          - hip_flexion_l
          - hip_adduction_l
          - hip_rotation_l
          - knee_angle_l
          - ankle_angle_l
      - type: JointVelArray
        obs_name: joint_velocities
        xml_names:
          - back_bkz
          - l_arm_shy
          - l_arm_shx
          - l_arm_shz
          - left_elbow
          - r_arm_shy
          - r_arm_shx
          - r_arm_shz
          - right_elbow
          - hip_flexion_r
          - hip_adduction_r
          - hip_rotation_r
          - knee_angle_r
          - ankle_angle_r
          - hip_flexion_l
          - hip_adduction_l
          - hip_rotation_l
          - knee_angle_l
          - ankle_angle_l
      - type: LastAction
        obs_name: last_action
    action_spec:
      - back_bkz_actuator
      - l_arm_shy_actuator
      - l_arm_shx_actuator
      - l_arm_shz_actuator
      - left_elbow_actuator
      - r_arm_shy_actuator
      - r_arm_shx_actuator
      - r_arm_shz_actuator
      - right_elbow_actuator
      - hip_flexion_r_actuator
      - hip_adduction_r_actuator
      - hip_rotation_r_actuator
      - knee_angle_r_actuator
      - ankle_angle_r_actuator
      - hip_flexion_l_actuator
      - hip_adduction_l_actuator
      - hip_rotation_l_actuator
      - knee_angle_l_actuator
      - ankle_angle_l_actuator
    control_type: ${control_config.position_control.control_type}
    control_params: ${control_config.position_control.control_params}
  hidden_layers: [512, 256]
  lr: 1e-4
  num_envs: 2048
  num_steps: 20
  total_timesteps: 50e7
  update_epochs: 4
  num_minibatches: 32
  gamma: 0.99
  gae_lambda: 0.95
  clip_eps: 0.2
  init_std: 0.8
  learnable_std: True
  ent_coef: 0.0
  vf_coef: 0.5
  max_grad_norm: 0.5
  activation: tanh
  anneal_lr: false
  weight_decay: 0.0
  normalize_env: true
  debug: false
  n_seeds: 1  # while automatically take seeds from 1 to n_seeds
  vmap_across_seeds: true
  validation:
    active: false
    num_steps: 100
    num_envs: 100
    num: 10 # set to 0 to disable validation


# Define control subconfigs
control_config:
  position_control:
    control_type: PDControl
    control_params:
      p_gain:
        - 300  # back_bkz_actuator -> torso
        - 100  # l_arm_shy_actuator -> shoulder
        - 100  # l_arm_shx_actuator -> shoulder
        - 100  # l_arm_shz_actuator -> shoulder
        - 100  # left_elbow_actuator -> elbow
        - 100  # r_arm_shy_actuator -> shoulder
        - 100  # r_arm_shx_actuator -> shoulder
        - 100  # r_arm_shz_actuator -> shoulder
        - 100  # right_elbow_actuator -> elbow
        - 200  # hip_flexion_r_actuator -> hip_pitch
        - 200  # hip_adduction_r_actuator -> hip_roll
        - 200  # hip_rotation_r_actuator -> hip_yaw
        - 300  # knee_angle_r_actuator -> knee
        - 40   # ankle_angle_r_actuator -> ankle
        - 200  # hip_flexion_l_actuator -> hip_pitch
        - 200  # hip_adduction_l_actuator -> hip_roll
        - 200  # hip_rotation_l_actuator -> hip_yaw
        - 300  # knee_angle_l_actuator -> knee
        - 40   # ankle_angle_l_actuator -> ankle
      d_gain:
        - 6  # back_bkz_actuator -> torso
        - 2  # l_arm_shy_actuator -> shoulder
        - 2  # l_arm_shx_actuator -> shoulder
        - 2  # l_arm_shz_actuator -> shoulder
        - 2  # left_elbow_actuator -> elbow
        - 2  # r_arm_shy_actuator -> shoulder
        - 2  # r_arm_shx_actuator -> shoulder
        - 2  # r_arm_shz_actuator -> shoulder
        - 2  # right_elbow_actuator -> elbow
        - 5  # hip_flexion_r_actuator -> hip_pitch
        - 5  # hip_adduction_r_actuator -> hip_roll
        - 5  # hip_rotation_r_actuator -> hip_yaw
        - 6  # knee_angle_r_actuator -> knee
        - 2  # ankle_angle_r_actuator -> ankle
        - 5  # hip_flexion_l_actuator -> hip_pitch
        - 5  # hip_adduction_l_actuator -> hip_roll
        - 5  # hip_rotation_l_actuator -> hip_yaw
        - 6  # knee_angle_l_actuator -> knee
        - 2  # ankle_angle_l_actuator -> ankle

  torque_control:
    control_type: DefaultControl
    control_params:
